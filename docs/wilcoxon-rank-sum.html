<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Wilcoxon Rank-Sum | Nonparametric Handbook</title>
  <meta name="description" content="Data Analyst’s Guide to Statistical Testing" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Wilcoxon Rank-Sum | Nonparametric Handbook" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ishaandey.com/nonparametric/" />
  <meta property="og:image" content="https://ishaandey.com/nonparametric/images/favicon/android-chrome-512x512.png" />
  <meta property="og:description" content="Data Analyst’s Guide to Statistical Testing" />
  <meta name="github-repo" content="ishaandey/nonparametric" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Wilcoxon Rank-Sum | Nonparametric Handbook" />
  
  <meta name="twitter:description" content="Data Analyst’s Guide to Statistical Testing" />
  <meta name="twitter:image" content="https://ishaandey.com/nonparametric/images/favicon/android-chrome-512x512.png" />

<meta name="author" content="Ishaan Dey" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon/favicon.ico" type="image/x-icon" />
<link rel="prev" href="two-sample-permutation.html"/>
<link rel="next" href="mann-whitney.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- 
Header 
  - included at the top (head) of every page
  - EDAV logo back to index.html
  - smiles on hover :)
-->

<!-- Free Font Awesome Stylesheet -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">

<!-- JS -->
<script>
document.getElementsByClassName('tablinks')[0].click()

function hover(element) {
  element.setAttribute('src', 'images/icons/edav_resource_url.png');
}

function unhover(element) {
  element.setAttribute('src', 'images/icons/edav_resource_url_no_smile.png');
}

function unrolltab(evt, tabName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

<!-- Anchor point for scroll-top button -->
<a id="top"></a>

<!-- URL Logo -->
<center>
<br><br>
<a href="index.html"><img src="images/icons/edav_resource_url_no_smile.png" onmouseover="hover(this);" onmouseout="unhover(this);" /></a>
</center>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/favicon/android-chrome-512x512.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why This Book?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-does-it-cover"><i class="fa fa-check"></i>What Does It Cover</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-are-you"><i class="fa fa-check"></i>Who Are You?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-are-we"><i class="fa fa-check"></i>Who Are We?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-basics"><i class="fa fa-check"></i>The Basics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i>Notation</a></li>
</ul></li>
<li class="part"><span><b>I Two Sample Inference</b></span></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a><ul>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#notation-1"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#diagnostics"><i class="fa fa-check"></i>Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="choosing-a-test.html"><a href="choosing-a-test.html"><i class="fa fa-check"></i>Choosing a Test</a></li>
<li class="chapter" data-level="1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html"><i class="fa fa-check"></i><b>1</b> Two Sample t-Test</a><ul>
<li class="chapter" data-level="1.1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#how-it-works"><i class="fa fa-check"></i><b>1.1</b> How It Works</a></li>
<li class="chapter" data-level="1.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#code"><i class="fa fa-check"></i><b>1.2</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html"><i class="fa fa-check"></i><b>2</b> Permutation Test</a><ul>
<li class="chapter" data-level="2.1" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#how-it-works-1"><i class="fa fa-check"></i><b>2.1</b> How It Works</a></li>
<li class="chapter" data-level="2.2" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#code-1"><i class="fa fa-check"></i><b>2.2</b> Code</a></li>
<li class="chapter" data-level="2.3" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#variants"><i class="fa fa-check"></i><b>2.3</b> Variants</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html"><i class="fa fa-check"></i><b>3</b> Wilcoxon Rank-Sum</a><ul>
<li class="chapter" data-level="3.1" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html#how-it-works-2"><i class="fa fa-check"></i><b>3.1</b> How It Works</a></li>
<li class="chapter" data-level="3.2" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html#code-2"><i class="fa fa-check"></i><b>3.2</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mann-whitney.html"><a href="mann-whitney.html"><i class="fa fa-check"></i><b>4</b> Mann-Whitney</a><ul>
<li class="chapter" data-level="" data-path="mann-whitney.html"><a href="mann-whitney.html#assumptions"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="4.1" data-path="mann-whitney.html"><a href="mann-whitney.html#how-it-works-3"><i class="fa fa-check"></i><b>4.1</b> How It Works</a><ul>
<li class="chapter" data-level="" data-path="mann-whitney.html"><a href="mann-whitney.html#formal-hypothesis-tests"><i class="fa fa-check"></i>Formal Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mann-whitney.html"><a href="mann-whitney.html#code-3"><i class="fa fa-check"></i><b>4.2</b> Code</a></li>
<li class="chapter" data-level="4.3" data-path="mann-whitney.html"><a href="mann-whitney.html#note"><i class="fa fa-check"></i><b>4.3</b> Note</a></li>
</ul></li>
<li class="part"><span><b>II Matched Pairs</b></span></li>
<li class="chapter" data-level="" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i>Summary</a><ul>
<li class="chapter" data-level="4.4" data-path="summary-1.html"><a href="summary-1.html#usage"><i class="fa fa-check"></i><b>4.4</b> Usage</a><ul>
<li class="chapter" data-level="4.4.1" data-path="summary-1.html"><a href="summary-1.html#assumptions-1"><i class="fa fa-check"></i><b>4.4.1</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="summary-1.html"><a href="summary-1.html#procedure"><i class="fa fa-check"></i><b>4.5</b> Procedure</a></li>
<li class="chapter" data-level="4.6" data-path="summary-1.html"><a href="summary-1.html#code-4"><i class="fa fa-check"></i><b>4.6</b> Code</a><ul>
<li class="chapter" data-level="4.6.1" data-path="summary-1.html"><a href="summary-1.html#r"><i class="fa fa-check"></i><b>4.6.1</b> R</a></li>
<li class="chapter" data-level="4.6.2" data-path="summary-1.html"><a href="summary-1.html#python"><i class="fa fa-check"></i><b>4.6.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="summary-1.html"><a href="summary-1.html#usage-1"><i class="fa fa-check"></i><b>4.7</b> Usage</a></li>
<li class="chapter" data-level="4.8" data-path="summary-1.html"><a href="summary-1.html#procedure-1"><i class="fa fa-check"></i><b>4.8</b> Procedure</a></li>
<li class="chapter" data-level="4.9" data-path="summary-1.html"><a href="summary-1.html#code-5"><i class="fa fa-check"></i><b>4.9</b> Code</a><ul>
<li class="chapter" data-level="4.9.1" data-path="summary-1.html"><a href="summary-1.html#r-1"><i class="fa fa-check"></i><b>4.9.1</b> R</a></li>
<li class="chapter" data-level="4.9.2" data-path="summary-1.html"><a href="summary-1.html#python-1"><i class="fa fa-check"></i><b>4.9.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="summary-1.html"><a href="summary-1.html#usage-2"><i class="fa fa-check"></i><b>4.10</b> Usage</a></li>
<li class="chapter" data-level="4.11" data-path="summary-1.html"><a href="summary-1.html#procedure-2"><i class="fa fa-check"></i><b>4.11</b> Procedure</a><ul>
<li class="chapter" data-level="4.11.1" data-path="summary-1.html"><a href="summary-1.html#r-2"><i class="fa fa-check"></i><b>4.11.1</b> R</a></li>
<li class="chapter" data-level="4.11.2" data-path="summary-1.html"><a href="summary-1.html#python-2"><i class="fa fa-check"></i><b>4.11.2</b> Python</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="summary-1.html"><a href="summary-1.html#usage-3"><i class="fa fa-check"></i><b>4.12</b> Usage</a></li>
<li class="chapter" data-level="4.13" data-path="summary-1.html"><a href="summary-1.html#procedure-3"><i class="fa fa-check"></i><b>4.13</b> Procedure</a><ul>
<li class="chapter" data-level="4.13.1" data-path="summary-1.html"><a href="summary-1.html#hypothesis"><i class="fa fa-check"></i><b>4.13.1</b> Hypothesis</a></li>
<li class="chapter" data-level="4.13.2" data-path="summary-1.html"><a href="summary-1.html#test-statistic"><i class="fa fa-check"></i><b>4.13.2</b> Test statistic</a></li>
<li class="chapter" data-level="4.13.3" data-path="summary-1.html"><a href="summary-1.html#p-value"><i class="fa fa-check"></i><b>4.13.3</b> p value</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="summary-1.html"><a href="summary-1.html#code-6"><i class="fa fa-check"></i><b>4.14</b> Code</a><ul>
<li class="chapter" data-level="4.14.1" data-path="summary-1.html"><a href="summary-1.html#r-3"><i class="fa fa-check"></i><b>4.14.1</b> R</a></li>
<li class="chapter" data-level="4.14.2" data-path="summary-1.html"><a href="summary-1.html#python-3"><i class="fa fa-check"></i><b>4.14.2</b> Python</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Correlation</b></span></li>
<li class="chapter" data-level="" data-path="summary-sheet.html"><a href="summary-sheet.html"><i class="fa fa-check"></i>Summary Sheet</a><ul>
<li class="chapter" data-level="" data-path="summary-sheet.html"><a href="summary-sheet.html#background-1"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="4.15" data-path="summary-sheet.html"><a href="summary-sheet.html#usage-4"><i class="fa fa-check"></i><b>4.15</b> Usage</a><ul>
<li class="chapter" data-level="4.15.1" data-path="summary-sheet.html"><a href="summary-sheet.html#assumption"><i class="fa fa-check"></i><b>4.15.1</b> Assumption</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="summary-sheet.html"><a href="summary-sheet.html#how-it-works-4"><i class="fa fa-check"></i><b>4.16</b> How It Works</a></li>
<li class="chapter" data-level="4.17" data-path="summary-sheet.html"><a href="summary-sheet.html#code-7"><i class="fa fa-check"></i><b>4.17</b> Code</a></li>
<li class="chapter" data-level="4.18" data-path="summary-sheet.html"><a href="summary-sheet.html#note-1"><i class="fa fa-check"></i><b>4.18</b> Note</a></li>
<li class="chapter" data-level="4.19" data-path="summary-sheet.html"><a href="summary-sheet.html#usage-5"><i class="fa fa-check"></i><b>4.19</b> Usage</a><ul>
<li class="chapter" data-level="4.19.1" data-path="summary-sheet.html"><a href="summary-sheet.html#assumptions-2"><i class="fa fa-check"></i><b>4.19.1</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4.20" data-path="summary-sheet.html"><a href="summary-sheet.html#how-it-works-5"><i class="fa fa-check"></i><b>4.20</b> How it Works</a><ul>
<li class="chapter" data-level="4.20.1" data-path="summary-sheet.html"><a href="summary-sheet.html#p-value-1"><i class="fa fa-check"></i><b>4.20.1</b> p-value</a></li>
</ul></li>
<li class="chapter" data-level="4.21" data-path="summary-sheet.html"><a href="summary-sheet.html#usage-6"><i class="fa fa-check"></i><b>4.21</b> Usage</a><ul>
<li class="chapter" data-level="" data-path="summary-sheet.html"><a href="summary-sheet.html#assumptions-3"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="4.21.1" data-path="summary-sheet.html"><a href="summary-sheet.html#how-it-works-6"><i class="fa fa-check"></i><b>4.21.1</b> How it Works</a></li>
<li class="chapter" data-level="4.21.2" data-path="summary-sheet.html"><a href="summary-sheet.html#p-value-2"><i class="fa fa-check"></i><b>4.21.2</b> p-value</a></li>
</ul></li>
<li class="chapter" data-level="4.22" data-path="summary-sheet.html"><a href="summary-sheet.html#how-it-works-7"><i class="fa fa-check"></i><b>4.22</b> How it Works</a></li>
<li class="chapter" data-level="4.23" data-path="summary-sheet.html"><a href="summary-sheet.html#limitations"><i class="fa fa-check"></i><b>4.23</b> Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ishaandey/nonparametric" target="blank">Published with Bookdown on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Nonparametric Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <script src="assets/hideOutput.js"></script>
  <link href="assets/style.css" rel="stylesheet">
</head>
<div id="wilcoxon-rank-sum" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Wilcoxon Rank-Sum</h1>
<p>Wilcoxon Rank-Sum is great for testing with low sample sizes and outliers, since it uses the rank of the observation as opposed to the value itself.</p>
<p>There’s only one <strong>assumption</strong>, that both population distribution are continuous (not categorical / discrete)</p>
<div id="how-it-works-2" class="section level2">
<h2><span class="header-section-number">3.1</span> How It Works</h2>
<p>The goal here is to use <em>ranks</em>, as opposed to the actual values, to identify differences in location between the two parameters. Why? Ranks are much more resistant to outliers, since a singly high observation is now just ranked at the max, doesn’t matter how far above in absolute value it is.</p>
<p>We can pool the observations and compare the ranks that were assigned to sample 1 against those assigned to sample 2. We can compare the average rank of sample 1 against sample 2, and if it’s lower by a particular margin, we can conclude that the values of sample 1 are below sample 2.</p>
<p>As an example:</p>
<table>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;color: #14366e !important;">
Sample 1
</td>
<td style="text-align:right;color: #14366e !important;">
31
</td>
<td style="text-align:right;color: #14366e !important;">
32
</td>
<td style="text-align:right;color: #14366e !important;">
33
</td>
<td style="text-align:right;color: #14366e !important;">
47
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;color: #636e14 !important;">
Sample 2
</td>
<td style="text-align:right;color: #636e14 !important;">
46
</td>
<td style="text-align:right;color: #636e14 !important;">
48
</td>
<td style="text-align:right;color: #636e14 !important;">
49
</td>
<td style="text-align:right;color: #636e14 !important;">
51
</td>
</tr>
</tbody>
</table>
<p>We’ll first calculate <span class="math inline">\(W_{obs}\)</span>, our test statistic. To do so, we’ll first pool both samples together and rank them, assigning a value of <code>1</code> to the smallest observation, and <code>m+n</code> to the largest (since there are now <span class="math inline">\(m+n\)</span> observations in the pooled group).</p>
<table>
<tbody>
<tr>
<td style="text-align:left;">
Values
</td>
<td style="text-align:center;">
<span style="     color: #14366e !important;">31</span>
</td>
<td style="text-align:center;">
<span style="     color: #14366e !important;">32</span>
</td>
<td style="text-align:center;">
<span style="     color: #14366e !important;">33</span>
</td>
<td style="text-align:center;">
<span style="     color: #14366e !important;">47</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">46</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">48</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">49</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">51</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ranks
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #14366e !important;">1</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #14366e !important;">2</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #14366e !important;">3</span>
</td>
<td style="text-align:center;">
<span style=" font-weight: bold;    color: #14366e !important;">5</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">4</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">6</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">7</span>
</td>
<td style="text-align:center;">
<span style="     color: #636e14 !important;">8</span>
</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(W_{obs}\)</span> is simply the <em>sum of ranks</em> of sample 1 observations: <span class="math inline">\(W_{obs}=\)</span> <span style="color: #79759d;">1+2+3+5</span> <span class="math inline">\(=11\)</span>.</p>
<p>Why use this instead of the mean of the ranks between the two? Turns out, the sum of ranks of one sample is a linear function of the mean, so there’s a 1:1 correspondence between the two. The sum of ranks is just more consistent and easy to calculate.</p>
<hr style="height:1px; width:60%;">
</hr>
<p>Under the null hypothesis, we’d expect our observations to have no difference in ranks. So, if we were to randomly switch around (permute) the observations across the samples, we’d expect our observed test statistic <span class="math inline">\(W_{obs}\)</span> to not be anything unusual, according to <span class="math inline">\(H_0\)</span>. In otherwords, random chance could have just as easily produced <span class="math inline">\(W_{obs}\)</span> as the treatment we gave.</p>
<p>Let’s make that idea a little more quantitative: If sample 1 has <span class="math inline">\(m\)</span> observations, and sample 2 has <span class="math inline">\(n\)</span> observations, there are <span class="math inline">\(\binom {m+n}{m} = \frac {(m+n)!}{m!n!}\)</span> permutations when we pool together our observations and reassign them to a group. We can calculate a test statistic <span class="math inline">\(W^*\)</span> for each one of these permutations.</p>
<p>Our p-value is then just the <em>fraction of permutations</em> that have a test statistic <span class="math inline">\(W\)</span> as or more extreme than what was observed <span class="math inline">\(W_{obs}\)</span>:</p>
<p>Going back to our example,</p>
<p>Here are</p>
<details>
<summary> P-value Formula </summary>
<p>
<p><span class="math inline">\(p-val_{two\ sided} = \frac{\text{# of W&#39;s more extreme than } W_{obs} \text{ across both tails}}{\binom {m+n}{m}}\)</span>
<br> <span class="math inline">\(p-val_{lower} = \frac{\text{# of }W\geq W_{obs}}{\binom {m+n}{m}}\)</span>
<br> <span class="math inline">\(p-val_{upper} = \frac{\text{# of }W\leq W_{obs}}{\binom {m+n}{m}}\)</span></p>
</p>
</details>
<p>In our example, there are <span class="math inline">\(\binom {8}{4}=70\)</span> possible ways we could’ve obtained the four observations in sample 1 from a total of eight values. We could lookup the significance from a table, or read off the p-value from the test output</p>
<p><strong>Interpretation</strong>: Given a p-value of 0.028, there is a 2.8% chance of observing a difference as extreme as we did under the hypothesis that these samples come from populations with the same distribution.</p>
<p>Because it’s less than our confidence threshold <span class="math inline">\(\alpha\)</span> of <span class="math inline">\(0.05\)</span>, we reject the null hypothesis that <span class="math inline">\(F_1(x) = F_2(x)\)</span>, and conclude that the location of population 1 is lower than population 2.</p>
</div>
<div id="code-2" class="section level2">
<h2><span class="header-section-number">3.2</span> Code</h2>
<div class="tab">
<button class="tablinks" onclick="unrolltab(event, &#39;R&#39;)">
R
</button>
<button class="tablinks" onclick="unrolltab(event, &#39;Python&#39;)">
Python
</button>
<div id="R" class="tabcontent">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="wilcoxon-rank-sum.html#cb5-1"></a><span class="kw">library</span>(stats)</span>
<span id="cb5-2"><a href="wilcoxon-rank-sum.html#cb5-2"></a></span>
<span id="cb5-3"><a href="wilcoxon-rank-sum.html#cb5-3"></a>sample1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">47</span>)</span>
<span id="cb5-4"><a href="wilcoxon-rank-sum.html#cb5-4"></a>sample2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">46</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">51</span>)</span>
<span id="cb5-5"><a href="wilcoxon-rank-sum.html#cb5-5"></a></span>
<span id="cb5-6"><a href="wilcoxon-rank-sum.html#cb5-6"></a><span class="kw">wilcox.test</span>(sample1, sample2, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  sample1 and sample2
## W = 1, p-value = 0.02857
## alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<div id="Python" class="tabcontent">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="wilcoxon-rank-sum.html#cb7-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ranksums</span>
<span id="cb7-2"><a href="wilcoxon-rank-sum.html#cb7-2"></a></span>
<span id="cb7-3"><a href="wilcoxon-rank-sum.html#cb7-3"></a>sample1 <span class="op">=</span> [<span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">47</span>]</span>
<span id="cb7-4"><a href="wilcoxon-rank-sum.html#cb7-4"></a>sample2 <span class="op">=</span> [<span class="dv">46</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">51</span>]</span>
<span id="cb7-5"><a href="wilcoxon-rank-sum.html#cb7-5"></a></span>
<span id="cb7-6"><a href="wilcoxon-rank-sum.html#cb7-6"></a>ranksums(sample1, sample2, alternative<span class="op">=</span><span class="st">&#39;less&#39;</span>)</span></code></pre></div>
</div>
</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by-nc/2.0/">CC-BY-NC </a>: You can download them by <a href="shared-illos.zip">clicking here</a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/2.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="two-sample-permutation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mann-whitney.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ishaandey/nonparametric/edit/master/content-two-sample-inference.Rmd",
"text": "Suggest An Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/ishaandey/nonparametric/raw/master/content-two-sample-inference.Rmd"],
"toc": {
"collapse": "section",
"toc_depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
