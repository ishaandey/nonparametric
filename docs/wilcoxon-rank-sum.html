<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Wilcoxon Rank-Sum | Nonparametric Handbook</title>
  <meta name="description" content="A handbook for applying statistical testing to big data." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Wilcoxon Rank-Sum | Nonparametric Handbook" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ishaandey.com/nonparametric/" />
  <meta property="og:image" content="https://ishaandey.com/nonparametric/images/favicon/android-chrome-512x512.png" />
  <meta property="og:description" content="A handbook for applying statistical testing to big data." />
  <meta name="github-repo" content="ishaandey/nonparametric" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Wilcoxon Rank-Sum | Nonparametric Handbook" />
  
  <meta name="twitter:description" content="A handbook for applying statistical testing to big data." />
  <meta name="twitter:image" content="https://ishaandey.com/nonparametric/images/favicon/android-chrome-512x512.png" />

<meta name="author" content="Ishaan Dey" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon/favicon.ico" type="image/x-icon" />
<link rel="prev" href="two-sample-permutation.html"/>
<link rel="next" href="mann-whitney.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<!-- 
Header 
  - included at the top (head) of every page
  - EDAV logo back to index.html
  - smiles on hover :)
-->

<!-- Free Font Awesome Stylesheet -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">

<!-- JS -->
<script>
function hover(element) {
  element.setAttribute('src', 'images/icons/edav_resource_url.png');
}

function unhover(element) {
  element.setAttribute('src', 'images/icons/edav_resource_url_no_smile.png');
}

function unrolltab(evt, tabName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

<!-- Anchor point for scroll-top button -->
<a id="top"></a>

<!-- URL Logo -->
<center>
<br><br>
<a href="index.html"><img src="images/icons/edav_resource_url_no_smile.png" onmouseover="hover(this);" onmouseout="unhover(this);" /></a>
</center>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/favicon/android-chrome-512x512.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why This Book?</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-does-it-cover"><i class="fa fa-check"></i>What Does It Cover</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-are-you"><i class="fa fa-check"></i>Who Are You?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-are-we"><i class="fa fa-check"></i>Who Are We?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i>Quick Start</a></li>
<li class="chapter" data-level="" data-path="foundations.html"><a href="foundations.html"><i class="fa fa-check"></i>Foundations</a><ul>
<li class="chapter" data-level="" data-path="foundations.html"><a href="foundations.html#statistics-basics"><i class="fa fa-check"></i>Statistics Basics</a></li>
<li class="chapter" data-level="" data-path="foundations.html"><a href="foundations.html#note-on-notation"><i class="fa fa-check"></i>Note on Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistics-in-your-workflow.html"><a href="statistics-in-your-workflow.html"><i class="fa fa-check"></i>Statistics in Your Workflow</a></li>
<li class="part"><span><b>I Two Sample Inference</b></span></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a><ul>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#notation"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#diagnostics"><i class="fa fa-check"></i>Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="choosing-a-test.html"><a href="choosing-a-test.html"><i class="fa fa-check"></i>Choosing a Test</a></li>
<li class="chapter" data-level="1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html"><i class="fa fa-check"></i><b>1</b> Parametric t-Test</a><ul>
<li class="chapter" data-level="1.1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#how-it-works"><i class="fa fa-check"></i><b>1.2</b> How It Works</a></li>
<li class="chapter" data-level="1.3" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#code"><i class="fa fa-check"></i><b>1.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html"><i class="fa fa-check"></i><b>2</b> Permutation Test</a><ul>
<li class="chapter" data-level="2.1" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#usage-1"><i class="fa fa-check"></i><b>2.1</b> Usage</a></li>
<li class="chapter" data-level="2.2" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#how-it-works-1"><i class="fa fa-check"></i><b>2.2</b> How It Works</a></li>
<li class="chapter" data-level="2.3" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#code-1"><i class="fa fa-check"></i><b>2.3</b> Code</a></li>
<li class="chapter" data-level="2.4" data-path="two-sample-permutation.html"><a href="two-sample-permutation.html#variants"><i class="fa fa-check"></i><b>2.4</b> Variants</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html"><i class="fa fa-check"></i><b>3</b> Wilcoxon Rank-Sum</a><ul>
<li class="chapter" data-level="3.1" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html#usage-2"><i class="fa fa-check"></i><b>3.1</b> Usage</a><ul>
<li class="chapter" data-level="" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html#assumptions-1"><i class="fa fa-check"></i>Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html#how-it-works-2"><i class="fa fa-check"></i><b>3.2</b> How It Works</a></li>
<li class="chapter" data-level="3.3" data-path="wilcoxon-rank-sum.html"><a href="wilcoxon-rank-sum.html#code-2"><i class="fa fa-check"></i><b>3.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mann-whitney.html"><a href="mann-whitney.html"><i class="fa fa-check"></i><b>4</b> Mann-Whitney</a><ul>
<li class="chapter" data-level="4.1" data-path="mann-whitney.html"><a href="mann-whitney.html#usage-3"><i class="fa fa-check"></i><b>4.1</b> Usage</a><ul>
<li class="chapter" data-level="" data-path="mann-whitney.html"><a href="mann-whitney.html#assumptions-2"><i class="fa fa-check"></i>Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mann-whitney.html"><a href="mann-whitney.html#how-it-works-3"><i class="fa fa-check"></i><b>4.2</b> How It Works</a></li>
<li class="chapter" data-level="4.3" data-path="mann-whitney.html"><a href="mann-whitney.html#code-3"><i class="fa fa-check"></i><b>4.3</b> Code</a></li>
<li class="chapter" data-level="4.4" data-path="mann-whitney.html"><a href="mann-whitney.html#note"><i class="fa fa-check"></i><b>4.4</b> Note</a></li>
</ul></li>
<li class="part"><span><b>II Matched Pairs</b></span></li>
<li class="chapter" data-level="" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="5" data-path="parametric-paired-t-test.html"><a href="parametric-paired-t-test.html"><i class="fa fa-check"></i><b>5</b> Parametric Paired T-Test</a><ul>
<li class="chapter" data-level="5.1" data-path="parametric-paired-t-test.html"><a href="parametric-paired-t-test.html#usage-4"><i class="fa fa-check"></i><b>5.1</b> Usage</a><ul>
<li class="chapter" data-level="5.1.1" data-path="parametric-paired-t-test.html"><a href="parametric-paired-t-test.html#assumptions-3"><i class="fa fa-check"></i><b>5.1.1</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="parametric-paired-t-test.html"><a href="parametric-paired-t-test.html#procedure"><i class="fa fa-check"></i><b>5.2</b> Procedure</a></li>
<li class="chapter" data-level="5.3" data-path="parametric-paired-t-test.html"><a href="parametric-paired-t-test.html#code-4"><i class="fa fa-check"></i><b>5.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="paired-permutation-test.html"><a href="paired-permutation-test.html"><i class="fa fa-check"></i><b>6</b> Paired Permutation Test</a><ul>
<li class="chapter" data-level="6.1" data-path="paired-permutation-test.html"><a href="paired-permutation-test.html#usage-5"><i class="fa fa-check"></i><b>6.1</b> Usage</a></li>
<li class="chapter" data-level="6.2" data-path="paired-permutation-test.html"><a href="paired-permutation-test.html#procedure-1"><i class="fa fa-check"></i><b>6.2</b> Procedure</a></li>
<li class="chapter" data-level="6.3" data-path="paired-permutation-test.html"><a href="paired-permutation-test.html#code-5"><i class="fa fa-check"></i><b>6.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="wilcoxon-signed-rank-test.html"><a href="wilcoxon-signed-rank-test.html"><i class="fa fa-check"></i><b>7</b> Wilcoxon Signed-Rank Test</a><ul>
<li class="chapter" data-level="7.1" data-path="wilcoxon-signed-rank-test.html"><a href="wilcoxon-signed-rank-test.html#usage-6"><i class="fa fa-check"></i><b>7.1</b> Usage</a></li>
<li class="chapter" data-level="7.2" data-path="wilcoxon-signed-rank-test.html"><a href="wilcoxon-signed-rank-test.html#procedure-2"><i class="fa fa-check"></i><b>7.2</b> Procedure</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sign-test.html"><a href="sign-test.html"><i class="fa fa-check"></i><b>8</b> Sign Test</a><ul>
<li class="chapter" data-level="8.1" data-path="sign-test.html"><a href="sign-test.html#usage-7"><i class="fa fa-check"></i><b>8.1</b> Usage</a></li>
<li class="chapter" data-level="8.2" data-path="sign-test.html"><a href="sign-test.html#procedure-3"><i class="fa fa-check"></i><b>8.2</b> Procedure</a><ul>
<li class="chapter" data-level="8.2.1" data-path="sign-test.html"><a href="sign-test.html#hypothesis"><i class="fa fa-check"></i><b>8.2.1</b> Hypothesis</a></li>
<li class="chapter" data-level="8.2.2" data-path="sign-test.html"><a href="sign-test.html#test-statistic"><i class="fa fa-check"></i><b>8.2.2</b> Test statistic</a></li>
<li class="chapter" data-level="8.2.3" data-path="sign-test.html"><a href="sign-test.html#p-value"><i class="fa fa-check"></i><b>8.2.3</b> p value</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sign-test.html"><a href="sign-test.html#code-6"><i class="fa fa-check"></i><b>8.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="choosing-which-test.html"><a href="choosing-which-test.html"><i class="fa fa-check"></i><b>9</b> Choosing Which Test</a></li>
<li class="part"><span><b>III Correlation</b></span></li>
<li class="chapter" data-level="" data-path="summary-sheet.html"><a href="summary-sheet.html"><i class="fa fa-check"></i>Summary Sheet</a><ul>
<li class="chapter" data-level="" data-path="summary-sheet.html"><a href="summary-sheet.html#background-1"><i class="fa fa-check"></i>Background</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parametric-ols.html"><a href="parametric-ols.html"><i class="fa fa-check"></i><b>10</b> Parametric OLS</a><ul>
<li class="chapter" data-level="10.1" data-path="parametric-ols.html"><a href="parametric-ols.html#usage-8"><i class="fa fa-check"></i><b>10.1</b> Usage</a><ul>
<li class="chapter" data-level="10.1.1" data-path="parametric-ols.html"><a href="parametric-ols.html#assumption"><i class="fa fa-check"></i><b>10.1.1</b> Assumption</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="parametric-ols.html"><a href="parametric-ols.html#how-it-works-4"><i class="fa fa-check"></i><b>10.2</b> How It Works</a></li>
<li class="chapter" data-level="10.3" data-path="parametric-ols.html"><a href="parametric-ols.html#code-7"><i class="fa fa-check"></i><b>10.3</b> Code</a></li>
<li class="chapter" data-level="10.4" data-path="parametric-ols.html"><a href="parametric-ols.html#note-1"><i class="fa fa-check"></i><b>10.4</b> Note</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="permutation-test-for-slope.html"><a href="permutation-test-for-slope.html"><i class="fa fa-check"></i><b>11</b> Permutation Test for Slope</a><ul>
<li class="chapter" data-level="11.1" data-path="permutation-test-for-slope.html"><a href="permutation-test-for-slope.html#usage-9"><i class="fa fa-check"></i><b>11.1</b> Usage</a><ul>
<li class="chapter" data-level="11.1.1" data-path="permutation-test-for-slope.html"><a href="permutation-test-for-slope.html#assumptions-4"><i class="fa fa-check"></i><b>11.1.1</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="permutation-test-for-slope.html"><a href="permutation-test-for-slope.html#how-it-works-5"><i class="fa fa-check"></i><b>11.2</b> How it Works</a><ul>
<li class="chapter" data-level="11.2.1" data-path="permutation-test-for-slope.html"><a href="permutation-test-for-slope.html#p-value-1"><i class="fa fa-check"></i><b>11.2.1</b> p-value</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spearmans-rank-correlation.html"><a href="spearmans-rank-correlation.html"><i class="fa fa-check"></i><b>12</b> Spearman’s Rank Correlation</a><ul>
<li class="chapter" data-level="12.1" data-path="spearmans-rank-correlation.html"><a href="spearmans-rank-correlation.html#usage-10"><i class="fa fa-check"></i><b>12.1</b> Usage</a><ul>
<li class="chapter" data-level="" data-path="spearmans-rank-correlation.html"><a href="spearmans-rank-correlation.html#assumptions-5"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="12.1.1" data-path="spearmans-rank-correlation.html"><a href="spearmans-rank-correlation.html#how-it-works-6"><i class="fa fa-check"></i><b>12.1.1</b> How it Works</a></li>
<li class="chapter" data-level="12.1.2" data-path="spearmans-rank-correlation.html"><a href="spearmans-rank-correlation.html#p-value-2"><i class="fa fa-check"></i><b>12.1.2</b> p-value</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="kendalls-tau.html"><a href="kendalls-tau.html"><i class="fa fa-check"></i><b>13</b> Kendall’s Tau</a><ul>
<li class="chapter" data-level="13.1" data-path="kendalls-tau.html"><a href="kendalls-tau.html#how-it-works-7"><i class="fa fa-check"></i><b>13.1</b> How it Works</a></li>
<li class="chapter" data-level="13.2" data-path="kendalls-tau.html"><a href="kendalls-tau.html#limitations"><i class="fa fa-check"></i><b>13.2</b> Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ishaandey/nonparametric" target="blank">GitHub Source</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Nonparametric Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <script src="assets/hideOutput.js"></script>
  <link href="assets/style.css" rel="stylesheet">
</head>
<div id="wilcoxon-rank-sum" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Wilcoxon Rank-Sum</h1>
<div id="usage-2" class="section level2">
<h2><span class="header-section-number">3.1</span> Usage</h2>
<p>Wilcoxon Rank-Sum is great for testing with low sample sizes and outliers, since it uses the rank of the observation as opposed to the value itself.</p>
<div id="assumptions-1" class="section level3 unnumbered">
<h3>Assumptions</h3>
<ol style="list-style-type: decimal">
<li>Both population distribution are continuous (not categorical / discrete)</li>
</ol>
</div>
</div>
<div id="how-it-works-2" class="section level2">
<h2><span class="header-section-number">3.2</span> How It Works</h2>
<p>The goal here is to use <em>ranks</em>, as opposed to the actual values, to identify differences in location between the two parameters. Why? Ranks are much more resistant to outliers, since a singly high observation is now just ranked at the max, doesn’t matter how far above in absolute value it is.</p>
<p>We’ll first calculate <span class="math inline">\(W_{obs}\)</span>, our test statistic. To do so, we’ll first pool both samples together and rank them, assigning a value of <code>1</code> to the smallest observation, and <code>m+n</code> to the largest (since there are now <span class="math inline">\(m+n\)</span> observations in the pooled group).</p>
<p><span class="math inline">\(W_{observed}\)</span> is simply the <em>sum of ranks</em> of sample 1 observations.</p>
<p>Why use this instead of the mean of the ranks between the two? Turns out, the sum of ranks of one sample is a linear function of the mean, so there’s a 1:1 correspondence between the two. The sum of ranks is just more consistent and easy to calculate.</p>
<p>As a quick example:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Obs 1</th>
<th align="right">Obs 2</th>
<th align="right">Obs 3</th>
<th align="right">Obs 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sample1</td>
<td align="right">39</td>
<td align="right">49</td>
<td align="right">55</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">sample2</td>
<td align="right">31</td>
<td align="right">33</td>
<td align="right">46</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>becomes</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Sample1</th>
<th align="right">Sample1</th>
<th align="right">Sample1</th>
<th align="right">Sample1</th>
<th align="right">Sample2</th>
<th align="right">Sample2</th>
<th align="right">Sample2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pooled</td>
<td align="right">39</td>
<td align="right">49</td>
<td align="right">55</td>
<td align="right">57</td>
<td align="right">31</td>
<td align="right">33</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left">ranks</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Under the null hypothesis, we’d expect our observations to have no difference in means. So, if we were to randomly switch around (permute) the observations across the samples, we’d expect our test statistic <span class="math inline">\(W^*\)</span> of the particular permutation to remain close to <span class="math inline">\(W_{obs}\)</span>.</p>
<p>If sample 1 has <span class="math inline">\(m\)</span> observations, and sample 2 has <span class="math inline">\(n\)</span> observations, there are <span class="math inline">\(\binom {m+n}{m} = \frac {(m+n)!}{m!n!}\)</span> permutations when we pool together our observations and reassign them to a group. We can calculate a test statistic <span class="math inline">\(W^*\)</span> for each one of these permutations.</p>
<p>Our p-value is then just the <em>fraction of permutations</em> that have a test statistic <span class="math inline">\(W\)</span> as or more extreme than what was observed <span class="math inline">\(W_{obs}\)</span>:</p>
<details>
<summary> P-value Formula </summary>
<p>
<p><span class="math inline">\(p-val_{two\ sided} = \frac{\text{# of W&#39;s more extreme than } W_{obs} \text{ across both tails}}{\binom {m+n}{m}}\)</span>
<br> <span class="math inline">\(p-val_{lower} = \frac{\text{# of }W\geq W_{obs}}{\binom {m+n}{m}}\)</span>
<br> <span class="math inline">\(p-val_{upper} = \frac{\text{# of }W\leq W_{obs}}{\binom {m+n}{m}}\)</span></p>
</p>
</details>
<p>Interpretation: Given a p-value of 0.06, there is a 6% chance of observing a difference as extreme as we did under the hypothesis that these samples come from populations with the same distribution.</p>
</div>
<div id="code-2" class="section level2">
<h2><span class="header-section-number">3.3</span> Code</h2>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by-nc/2.0/">CC-BY-NC </a>: You can download them by <a href="shared-illos.zip">clicking here</a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/2.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="two-sample-permutation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mann-whitney.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ishaandey/nonparametric/edit/master/content-two-sample-inference.Rmd",
"text": "Suggest An Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/ishaandey/nonparametric/raw/master/content-two-sample-inference.Rmd"],
"toc": {
"collapse": "section",
"toc_depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
